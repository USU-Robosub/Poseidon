<!DOCTYPE HTML>

<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>USUb</title>
		<script type="text/javascript" src="/riot/riot+compiler.min.js"></script>
		<script type="text/javascript" src="/axios/axios.min.js"></script>

		<script type="riot/tag">
			<get-tag>
				<div>
					<button onclick={ get }>{ url }</button>
					<p>Result: { result }</p>
				</div>

				var self = this;
				self.url = self.opts.url;
				self.timer;
				self.running = false;

				self.get = function() {
					axios.get(self.opts.url).then(function (response) {
						self.result = response.data;
						self.update();
					});
				};

				self.toggle = function() {
					if (!self.running) {
						self.running = true;
						self.get(); // Run immediately
						self.timer = setInterval(self.get, 1000);
					}
					else {
						self.running = false;
						clearInterval(self.timer);
						self.result = '';
						self.update();
					}
				};
			</get-tag>
			<post-tag>
				<div>
					<button onclick={ post }>{ url }</button>
					<div each={ argument, i in arguments }>{ argument }<input type="number" id={ argument }/></div>
					<p>Result: { result }</p>
				</div>

				var self = this;
				self.url = self.opts.url;
				self.arguments = JSON.parse(self.opts.arguments);

				self.post = function() {
					var a = {}
					for (var aIndex in self.arguments) {
						a[self.arguments[aIndex]] = self[self.arguments[aIndex]].value;
					}
					axios.post(self.opts.url, a).then(function (response) {
						self.result = response.data;
						self.update();
					});
				};
			</post-tag>
		</script>
	</head>

	<body>
		<div>
			<div style="width: 50%; float: left;">
				<get-tag url='/initialize'></get-tag>
				<get-tag url='/getForwardAccel'></get-tag>
				<get-tag url='/getStrafeAccel'></get-tag>
				<get-tag url='/getDiveAccel'></get-tag>
				<get-tag url='/getForwardAngle'></get-tag>
				<get-tag url='/getStrafeAngle'></get-tag>
				<get-tag url='/getDiveAngle'></get-tag>
				<get-tag url='/turnOnEscs'></get-tag>
				<get-tag url='/turnOffEscs'></get-tag>
			</div>
			<div style="width: 50%; float: right;">
				<post-tag url='/thrust' arguments='["powerLevel"]'></post-tag>
				<post-tag url='/goDirection' arguments='["forward", "strafe", "dive"]'></post-tag>
				<post-tag url='/faceDirection' arguments='["yaw"]'></post-tag>
				<post-tag url='/setForwardThrust' arguments='["velocity"]'></post-tag>
				<post-tag url='/setDiveThrust' arguments='["velocity"]'></post-tag>
				<post-tag url='/setStrafeThrust' arguments='["velocity"]'></post-tag>
				<post-tag url='/setYawThrust' arguments='["velocity"]'></post-tag>
			</div>
		</div>
		<script type="text/javascript">
			riot.mount('*');
		</script>
	</body>
</html>
